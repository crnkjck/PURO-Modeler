<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>OBOWLMorph</title>
        <link rel="stylesheet" href="../styles/basic.css">
        <!--
        <link rel="stylesheet" href="dijit/themes/claro/claro.css">
	
		<script>dojoConfig = {parseOnLoad: true};</script>
		<script src='dojo/dojo.js'></script>
	
		<script>
			require(["dojo/parser", "dijit/Dialog"]); //, "dijit/form/Button", "dijit/form/TextBox", "dijit/form/DateTextBox", "dijit/form/TimeTextBox"
		</script> -->
	
	
	    <script src="../d3.v3.js"></script>
	    <script src="../purostrings.js"></script>
	    <script src="../settings.js"></script>
        <script src="../puromodel.js"></script>
        
        <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="../jquery.rdfquery.core-1.0.js"></script>
        <script src="http://spin.js.org/spin.min.js"></script>
        
        <script src="../puroserializer.js"></script>
        <script src="../puroloader.js"></script>
	    <script src="../purocontroller.js"></script>
	  	<script src="../puroview.js"></script>
	  	<script src="../puroEditor.js"></script>
	  	
		 <script src='/puromodeler/dojo/dojo.js' djConfig="isDebug: true, parseOnLoad: true"></script>
		 
		<!-- <script src='dojox/data/XmlStore.js'></script> -->
	  	
	  	
	<style>	
	
		text {
		  font: 16px Helvetica Neue, Helvetica, Arial, sans-serif;
		  text-anchor: middle;
		  pointer-events: none;
		}
		
		circle {
		  fill: #ccc;
		}
		
		.node:hover circle {
		  fill: #FFA500;
		}
				
		.node path {
			fill: #FFEECA;
			cursor: pointer;
			stroke: #ccc;
			stroke-width: 1px;
		}		
		
		.mapping path {
			fill: #dddddd;
			cursor: pointer;
			stroke: #aaa;
			stroke-width: 1px;			
		}
		
		path.selected {
			fill: #FFC125 !important;
		}
		
		.selected path {
			fill: #FFC125 !important;
		}
		
		.node path:hover {
			fill: #FFA500;
		}
		
		.linklabelholder path {
			opacity: 0.0;
		}
		
		.linklabelholder text {
			font-size: 14;
			fill: #777777
		}
		
		.typelabel text {
			fill: #cccccc;
		}
		
		text.vocabPath {
			font-size: 14;
			font-weight: bold;
		}
		
		.vocabPath rect {
			stroke-width:1;
			stroke: #000000;
		}
		
		.button {
		   border-top: 1px solid #d6d6d6;
		   background: #d6d6d6;
		   /*
		   background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));
		   background: -webkit-linear-gradient(top, #3e779d, #65a9d7);
		   background: -moz-linear-gradient(top, #3e779d, #65a9d7);
		   background: -ms-linear-gradient(top, #3e779d, #65a9d7);
		   background: -o-linear-gradient(top, #3e779d, #65a9d7);*/
		   padding: 3px 5px;
		   -webkit-border-radius: 13px;
		   -moz-border-radius: 13px;
		   border-radius: 13px;
		   text-shadow: rgba(0,0,0,.4) 0 1px 0;
		   color: black;
		   font-size: 12px;
		   font-family: Helvetica, Arial, Sans-Serif;
		   text-decoration: none;
		   vertical-align: middle;
		   }
		.button:hover {
		   border-top-color: #28597a;
		   background: #28597a;
		   color: #ccc;
		   }
		.button:active {
		   border-top-color: #d6d6d6;
		   background: #d6d6d6;
		   }
		   
		.roundbox {
			-webkit-border-radius: 15px;
			border-radius: 15px;
			border: 6px #d6d6d6 solid;
			
			-moz-box-shadow: inset 0px 0px 13px 3px #d6d6d6;
			-webkit-box-shadow: inset 0px 0px 13px 3px #d6d6d6;
			box-shadow: inset 0px 0px 13px 3px #d6d6d6;
		}
		
		.roundboxNoShadow {
			-webkit-border-radius: 15px;
			border-radius: 15px;
			border: 6px #d6d6d6 solid;			
		}
		
		.settingsPopUp {
			-webkit-border-radius: 15px;
			border-radius: 15px;
			border: 6px #d6d6d6 solid;		
			background: #cccccc; padding:5px; opacity:0.8;
			color: black;
			font-weight: bold;		
		
		}
		
		.toolheading {
			font: 14px Helvetica Neue, Helvetica, Arial, sans-serif;
			color: grey;
			font-weight: bold;
		}
	</style>

    </head>
    <body id="#body">
    	<!--
    	<div data-dojo-type="dijit/Dialog" data-dojo-id="myFormDialog" title="Form Dialog">

	    	<div class="dijitDialogPaneContentArea" id="selectModelDlg">
	    		
	    	</div>
    	</div>
    	-->
    	
    	<div style="position:absolute; left:500px; top:200px; width:230px; height:120px; z-index:99998; "
    		 id="nodeProps" class="settingsPopUp">
	        		Modeling Style for the Selected Entity
	        		<div id="modelingStyles"></div>
	        		<!-- <br>
	        		<input type="checkbox" id="chbPerdurant"> May change in time (anti-rigid) -->
	    </div>
	    
	    <div style="position:absolute; left:500px; top:200px; width:230px; height:120px; z-index:99998; background: #cccccc;"
    		 id="nodeMappings" class="settingsPopUp">
    		 		Available mappings to vocabularies
	        		<div id="mappingChoices"></div>
	    </div>
	    
	    <div style="visibility:hidden; position:absolute; left:400px; top:250px; width:230px; height:280px; z-index:99999;"
    		 id="mappingProgressDiv" class="settingsPopUp">
    		 		Please wait, searching for relevant existing vocabularies...
    		 		(It can take a minute, be patient.)
    		 		Also, the service might not work during July 21-24 due to server maintenance.
	    </div>
	    
	    <div style="visibility:hidden; position:absolute; left:500px; top:200px; width:500px; height:450px; z-index:99998;"
    		 id="mappingInfoWindow" class="settingsPopUp">
    		 		Details about the possible mapping (if dereferencing works)
	        		<iframe id="mappingInfoFrame" width="100%" height="420px"></iframe>
	    </div>
    	
        <div style="margin:30px;" >
	        <div style="float:left;">
	        	<div style="font: 36px Helvetica Neue, Helvetica, Arial, sans-serif; color:#B60000;">OBOWLMorph</div>
            <div style="font: Helvetica Neue, Helvetica, Arial, sans-serif;"><a href="#about">About this app</a> <a href="#about">Help</a> Please note that due to server maintenance the app might not work properly during July 21-24.</div>
	        	<br/>
	        	<div id="divLogin">
	        		User: <input type="text" id="user" style="display:inline;width:70px" > Pass: 
	        		<input type="password" id="pass" style="display:inline;width:70px" > 
		        	<input type="button" id="btnLoadObmList" value="Login">
		        	<div id="divLoginMessage"></div>
	        	</div>
	        	     	
		     
	        </div>
	        
	        <div style="clear:both"></div>
	        <div style="width:49.5%;float:left;">
	        <div style="display:inline " class="toolheading">Displayed Model: </div><div style="display:inline" id="modelname" class="toolheading"> </div>
	        	<a href="#loadlist" title="Load an existing model.">Load Model</a>&nbsp&nbsp
	        	<a href=".." target="_blank" title="Create a new OBM in PURO Modeler">Create New</a>
	        	
	        	<span id="tooltip" class="toolheading"></span>
	        	<div style="height:700px; margin:0px;" id="canvas" class="roundboxNoShadow"> </div>
	        </div>
	        	 
	        <div style="float:right; width:49.5%; margin:0px;">
		        <div>
		        	<input type="button" value="Update OWL Representation" id="btnUpdateOWL" class="button" title="Update OWL representation">
		        	<a href="" id="ofmDownloadLink">Download OWL Representation</a>&nbsp
		        	<a href="" id="ofmVisualLink" target="_blank">Open VOWL in new window</a>
		        </div>
		        <div>
		        	<iframe src="" id="vowlFrame" width="100%" height="700px"></iframe>
		        </div>
	        </div>
	        <div style="clear:both"><input type="button" value="Start/Stop Auto-Layout" id="btnLayout"  class="button"></div>
	        <div style="margin-top:10px; font: 12px Helvetica Neue, Helvetica, Arial, sans-serif;
		        			padding:5px; width:350px; float:left"  class="roundbox">
		        	<a id="loadlist" class="toolheading">Load an Existing PURO Model:</a> 
		        	<table id="obmTable" >
		        		
		        	</table>
		        </div>
		    <div id="about" style="margin-top:10px; font: 12px Helvetica Neue, Helvetica, Arial, sans-serif;
		        			padding:5px; width:60%; float:right">
		        <h3>What is this</h3>
		        OBOWLMorph is an app that can load a PURO OBM model created in <a href="..">PURO Modeler</a>,
		        let the user choose desired modeling style for each entity in the model and generate a basis of OWL an ontology from it.
		        <h3>How to use it</h3>
		        <h4>Login</h4>
		        There is a login feature that provides separation of users workspace, but no security. 
		        You can use account "demo" with password "demo" to test the app.
		        <h4>Load an Ontology Background Model</h4>
		        A list of available PURO OBMs is in the lower left corner. 
		        Click on any of them to load it. It will be displayed in the left frame using node-link visualization.
		        During the load, a search for relevant vocabularies that could be used to describe the modeled situation will be performed. 
		        It uses ontology matching tools to search Linked Open Vocabularies and it may take a minute or two to finnish.
		        When relevant vocabularies are found, parts of the model that could be described by an existing vocabulary are encircled
		        (highlighted) with different colors - each vocabulary has its color.
		        You can re-arrange the nodes by drag&dropping them or letting the app do it for you by clicking the "Start/stop auto-layout" button.
		        Move the around the visualization by drag&dropping outside the nodes, zoom-in or out with mousewheel.
		        <br>
		        You can also <b>create a new model</b>: clicking the "Create new" link at the top of the page. It takes you to
		        PURO Modeler web application.
		        Create the model in it and save it and then refresh the OBOWLMorph page to display it in the list. (PURO Modeler
		        and OBOWLMorph share the same DB hosted at server side.)
		        <br>
		        <h4>Select Modeling Styles</h4>
		        If you click on any of the nodes, a pop-up window will be shown where you can select target OWL modeling style for the entity.
		        You don't have to do this - a default modeling style will be used for all entities where you don't select another one.
		        To hide the window, click anywhere outside it and outside the nodes. The selection is saved at the moment you click on an option.
		        <h4>Reusing entities from existing vocabularies</h4>
		        If you click on a node that is encircled/highlighted by some colored line or lines, showing that there is a vocabulary 
		        containing an entity with possibly similar meaning, another pop-up window will appear. It shows a list of entities found 
		        through ontology matching tools. If you select one, it will be used in the OWL ontology generation process 
		        to model the given PURO entity. When you hover over the name of an entity in the list, it will be dereferenced and 
		        the result shown in another pop-up window - this of course depends on whether dereferencing for given vocabulary URIs 
		        is supported, which usually is not. Note that reusing entities works only if you keep the default modeling style 
		        (Object-prop and subclassing style) selected for OBM entities where you want to reuse some existing OWL entity. (This part is in more experimental state than the rest of the app.)
		        <h4>Generate an OWL Ontology from the Background Model</h4>
		        To generate an ontology basis from the PURO OBM, click "Update OWL Representation" button (above the right frame).
		        The result will be visualized in <a href="http://vowl.visualdataweb.org/webvowl">WebVOWL</a> inside the right frame.
		        You can download the ontology basis in n-triples using the link above the frame.
		        <h3>Further info</h3>
		        This application has been created at the Department of Information and Knowledge Engineering of University of Economics, 
		        Prague and funded by project no. F4/90/2015. Feel free to contact us at marek.dudas@vse.cz.
		          
		    </div>    
        </div>
    </body>   
    <script type="text/javascript">
    	PuroAppSettings.setOBOWLMorphFunctionality();
    	
    	var PuroApp = new PuroEditor(
    			"tools", 
    			"canvas",
    			"obmTable",
    			800,700
    		);

    	PuroApp.loadModelFromUrl();
    </script>
</html>
